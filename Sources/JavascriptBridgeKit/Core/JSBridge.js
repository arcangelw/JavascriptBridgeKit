var A=a=>typeof a=='function',{defineProperty:b}=Object,c=a=>typeof a=='string';(function(_,B){typeof exports=='object'&&typeof module!=='undefined'?module.exports=B():typeof define=='function'&&define.amd?define(B):(_=typeof globalThis!=='undefined'?globalThis:_||self,_.JSNativeBridge=B())})(this,(function(...args){'use strict';var C=function(){function _a(){}_a.dispatchMessage=d=>{var D=document.querySelectorAll('iframe');if(D){var _C=D.length;for(var i=0;i<_C;i++){var E=D[i].contentWindow;E.postMessage(d,'*')}}};_a.addMessageListener=()=>window.addEventListener('message',function(e){var _B=e.data;if(c(_B)){var aA=_B;aA.indexOf('messageType')!==-1&&window.JSNativeBridge.handleMesageFromNative(aA)}});_a.setupHook=()=>{document.addEventListener('DOMContentLoaded',function(){var aB=document.querySelectorAll('iframe');if(aB){var aC=aB.length;for(var i=0;i<aC;i++){var _d=aB[i];_d.getAttribute('sandbox')&&_d.getAttribute('sandbox').indexOf('allow-scripts')==-1&&_d.setAttribute('sandbox',_d.getAttribute('sandbox')+' allow-scripts')}}});var _A=document.createElement;document.createElement=aD=>{var aE=_A.call(document,aD);if(aD.toLowerCase()=='iframe')try {var aF=Object.getOwnPropertyDescriptor(window.HTMLIFrameElement,'sandbox')||Object.getOwnPropertyDescriptor(HTMLIFrameElement.prototype,'sandbox');aF?.configurable&&b(aE,'sandbox',{configurable:!0,enumerable:!0,get:function(){return aF.get.call(aE)},set:function(aG){if(aG.indexOf('allow-scripts')==-1)aG=`${aG} allow-scripts`;aF.set.call(aE,aG)}})} catch (e) {console.log('this browser does not support reconfigure iframe sandbox property',e)}return aE}};return _a}(),_b=function(){function aH(){this.uniqueId=-1;this.callbackCache={};this.eventCallbackCache={};this.moduleNames=[]}aH.prototype.clearAllModules=function(){for(const aI of this.moduleNames){window[aI]=null;delete window[aI]}this.moduleNames=[]};aH.prototype.clearModule=function(aJ){window[aJ]=null;delete window[aJ]};aH.prototype.injectNativeScript=function(aK,aL,aM){this.moduleNames.push(aK);var _D=JSON.parse(aL),_e=window[aK]||(window[aK]={'_sync':[]}),f=_e['_sync'];for(const aN of _D){aM&&f.indexOf(aN)==-1&&f.push(aN);var g=aN.replace(':','');!_e[g]&&(_e[g]=()=>{var aO=Array.prototype.slice.call(args)||[],aP=g+aO.map(()=>':').join('');if(f.indexOf(aP)==-1)window.JSNativeBridge.callNative(aK,aP,aO);else return window.JSNativeBridge.syncCallNative(aK,aP,aO)})}};aH.prototype.messageDataWrapper=function(aQ,aR,aS){var aT=[];for(var i=0;i<aS.length;i++){var F=aS[i];if(A(F)){var G='cb_'+aQ+'_'+aR+'_'+(this.uniqueId++)+'_'+new Date().getTime(),h={callbackId:G};this.callbackCache[G]=F;aT.push(h)}else aT.push(F)}return aT};aH.prototype.callNative=function(aU,aV,aW){window.webkit.messageHandlers.iOS_Native_JSBridgeMessage.postMessage({module:aU,method:aV,data:this.messageDataWrapper(aU,aV,aW)})};aH.prototype.syncCallNative=function(aX,aY,aZ){var bA=JSON.stringify({module:aX,method:aY,data:this.messageDataWrapper(aX,aY,aZ)});try {var _E=window.prompt('iOS_Native_JSBridgeMessage',bA),_f=_E?JSON.parse(_E):null;return _f.value} catch (e) {console.log('window.prompt will happen error when beforeunload event triggered',e);return null}};aH.prototype.handleMesageFromNative=function(bB){var bC=JSON.parse(bB);if(bC.messageType=='callback'){var bD=this.callbackCache[bC.callbackId];bD&&(bD.apply(null,bC.data),this.callbackCache[bC.callbackId]=null,delete this.callbackCache[bC.callbackId])} else if(bC.messageType=='event'){var bE=this.eventCallbackCache[bC.callbackId];if(bE)for(var i=0;i<bE.length;i++){var _F=bE[i];_F&&_F.apply(null,bC.data)}}C.dispatchMessage(bB)};aH.prototype.on=function(bF,bG){var bH=this.eventCallbackCache[bF];bH?bH.push(bG):bH=[bG]};aH.prototype.off=function(bI){var bJ=this.eventCallbackCache[bI];bJ&&bJ.length>0&&bJ.splice(0,bJ.length)};return aH}(),_c=function(){function bK(){}bK.moduleName='cookieSync';bK.setupHook=()=>{try {var bL=Object.getOwnPropertyDescriptor(Document.prototype,'cookie')||Object.getOwnPropertyDescriptor(HTMLDocument.prototype,'cookie');bL?.configurable&&b(document,'cookie',{configurable:!0,enumerable:!0,get:function(){if(window.JSNativeBridgeKitConfig.cookieGetHook)return window.JSNativeBridge.callNative(bK.moduleName,'getCookie',[window.location.href]);return bL.get.call(document)},set:function(bM){if(window.JSNativeBridgeKitConfig.cookieSetHook)window.JSNativeBridge.callNative(bK.moduleName,'setCookie',[bM]);bL.set.call(document,bM)}})} catch (e) {console.log('this browser does not support reconfigure document.cookie property',e)}};return bK}();function(){if(window.JSNativeBridge)return;window.JSNativeBridge=new _b();window.JSNativeBridgeKitConfig=function(){function bN(){}bN.cookieSetHook=!0;bN.cookieGetHook=!0;bN.enableCookieSetHook=bO=>bN.cookieSetHook=bO;bN.enableCookieGetHook=bP=>bN.cookieGetHook=bP;return bN}();C.addMessageListener();C.setupHook();_c.setupHook()}();return window.JSNativeBridge}));
